---
title: data architecture
top: false
cover: false
toc: true
mathjax: true
date: 2024-07-05 09:21:42
password:
summary:
tags:
categories:
---
# 常用数据架构
大数据架构
AI数据特点
  1. 多维度性：AI数据涉及从传感器到日志文件的多种数据类型。例如，自动驾驶汽车会产生图像、视频、雷达和激光雷达数据，这些数据不仅多样而且结构复杂，传统的关系数据库难以有效存储和查询这种多维度数据。
  2. 高速变化：AI系统，特别是自动驾驶技术，会生成高速流动的数据。这些数据需要快速处理以实时响应。例如，自动驾驶汽车的感知系统必须能够实时处理周围环境的数据以做出驾驶决策。
  3. 大规模数据集：AI训练和推断需要大量数据。自动驾驶汽车每天可以生成TB级别的数据，这要求有能力处理和分析大规模数据集的架构。
  4. 实时分析需求：AI应用，比如自动驾驶，需要对数据进行实时分析以快速做出决策。这意味着数据架构必须支持流处理和实时分析。（实时分析，把一些AI应用和决策放入云端实现，比如车震报警器此类，dms疲劳监测报警，障碍物信息动态上云，类似高德的堵车提醒）
  5. 灵活性和扩展性：随着技术的进步和业务需求的变化，AI数据的处理和分析需求也会变化。因此，数据架构需要有足够的灵活性和扩展性来适应这些变化。
为什么选择数据湖
  1. 灵活性：数据湖允许存储多种格式的数据，从而支持AI数据的多维度性。它不要求预先定义数据模式，这意味着可以更快地集成新的数据源，并且可以存储原始数据，在未来根据需要进行解析和处理。
  2. 可扩展性：数据湖架构可以横向扩展，以处理大规模数据集。随着自动驾驶数据量的增加，可以简单地增加更多的存储和计算资源，而不会受到传统数据库的限制。
  3. 成本效益：数据湖可以部署在低成本的硬件上，甚至可以在云环境中以服务的形式存在，这有助于控制存储和处理大量数据的成本。
  4. 实时处理能力：结合流处理技术、kafka、flink，数据湖可以支持实时数据摄取和分析，满足自动驾驶汽车实时分析的需求。
  5. 未来适应能力：数据湖架构为未来的技术发展提供了空间，可轻松集成新的分析工具和数据处理技术，以适应AI领域的快速发展。
常见架构
Lambda 架构
Lambda 架构是一种大数据处理架构，它结合了批处理和流处理的能力。它由三个主要层组成：
1. 批处理层（Batch Layer）：负责处理大量的历史数据，通常是不变的数据集，以生成批视图。
2. 速度层（Speed Layer）：处理实时数据流，以便快速提供最新的数据视图。
3. 服务层（Serving Layer）：将批处理层和速度层的结果合并起来，以提供一个全面的数据视图。
Lambda 架构的缺点包括：
- 复杂性：需要维护两套逻辑，一套用于批处理，一套用于流处理。
- 数据延迟：批处理层可能会导致数据处理有延迟，因为批处理作业通常是周期性运行的。
- 资源密集：由于维护两套系统，Lambda 架构可能需要更多的计算资源和开发工作。

Kappa 架构
Kappa 架构是对 Lambda 架构的简化，它只使用一个流处理系统来处理实时和历史数据。这意味着所有数据，无论是实时的还是历史的，都通过同一流处理管道。
Kappa 架构的优点是：
- 简化的系统设计：只需维护一套处理逻辑。
- 减少数据延迟：所有数据几乎可以即时处理，减少了数据到达服务层的时间。
Kappa 架构的缺点可能包括：
- 对流处理系统的依赖：所有的数据处理都依赖于流处理系统的性能和可靠性。
- 处理历史数据的挑战：处理大量历史数据可能会对流处理系统造成压力。

我们的架构：
数据湖架构（基础+批数据处理，后续全改为流处理），基于AI训练的特征，数据结构以非结构化为主，分析工具无法单独使用hadoop套件完成；
非结构数据进各类型桶；接下游使用；
结构化数据进spark+iceberg；接海豚调度，进ck和iceberg，可视化用tableau powerbi superset
批流一体数据处理用kafka，spark+flink；etl，单独写python、java程序，挂定时调度；

数据湖：即一个集中的存储仓库，可以存储大量结构化和非结构化数据，并保持其原始形式。

总结来说，数据湖架构由于其灵活性、可扩展性、成本效益和对实时数据处理的支持，在面对自动驾驶汽车这种高速生成多维度数据的应用场景时，相比 Lambda 和 Kappa 架构，是一个更合适的选择。

数据湖与 Lambda/Kappa 架构的比较

在自驾的场景中，即使 Lambda 和 Kappa 架构都能处理大规模数据集，但以下方面却不及数据湖架构：
1. 复杂性：Lambda 架构的双处理系统可能过于复杂，增加了维护成本和出错的可能性。
2. 实时性与延迟：Lambda 架构的批处理层可能不能满足自动驾驶汽车对实时数据处理的需求。虽然 Kappa 架构提供了实时处理，但在处理大量历史数据时可能会受到限制。
3. 灵活性和扩展性：数据湖提供了更大的灵活性和扩展性，可以存储不同格式的数据，而 Lambda 和 Kappa 架构通常需要数据在进入系统前就被格式化。
4. 成本效益：数据湖可以更高效地使用存储和计算资源，因为它们通常是构建在廉价硬件或者云服务上的，而 Lambda 和 Kappa 架构可能需要更多的专用资源。
5. 未来适应性：数据湖架构更容易适应新技术和新需求，因为它不要求严格的数据模式和处理流程。


http://superset.adc-ingress.aeroht.net/superset/dashboard/11/?native_filters_key=XJU7y-RXs8tmWo7WGbmu60_vD6e8MwkS4W0Vh8C-Gn3NsEhXAoiA8MgTs2YqTVo1
下阶段发力的方向
数据产线的效率监控——地图、感知；
每架次的性能报表-维护；——软件组；
应用的效果评估；——感知、规划；
webrviz的应用优化和推广；——感知、规划、测试；
日志的etl泛化；场景库，动态评估算法的表现，挖掘算法在不同场景下的差异，帮助提高；——增加清洗数据；
